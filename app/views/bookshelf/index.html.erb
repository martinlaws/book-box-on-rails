<div class="row">
  <h2 class="header-box">
    <center style="margin-top: 0.5em;"><%= current_user.name %>'s Books:</center>
  </h2>
</div>

<div class="container">
  <div class="flex-container">
    <% current_user.books.each do |book| %>
      <div class="four columns book-tile">
        <% if book %>
          <h4><a href="/book/<%= book.title %>"><%= book.title %></a></h4>
          <p>by: <%= book.author %></p>
          <p><%= book.genre %></p>
          <% if book.availability %>
            <%= button_to "Make Unavailable", toggle_availability_books_path(book: book.id), remote: true, class: :availability %>
          <% else %>
            <%= button_to "Repost", toggle_availability_books_path(book: book.id), remote: true, class: :availability %>
          <% end %>
        <% end %>
      </div>
    <% end %>
  </div>

  </br>

  <h4 class="docs-header"><center>Here's who wants your books:</center></h4>
  <table class="u-full-width">
    <thead>
      <tr>
        <th>Book</th>
        <th>Bidder</th>
        <th>Location</th>
        <th>Yea</th>
        <th>Neigh</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <% current_user.posting_trades.where(:status => "pending").each do |trade| %>
          <% book = Book.find(trade.book_id) %>
          <% receiving_user = User.find(trade.receiving_user) %>
          <td><a href="/book/<%= book.title %>"><%= book.title %></a></td>
          <td><%= receiving_user.name %> </td>
          <td><%= receiving_user.location.address %></td>
          <td>
          <%= button_to accept_trade_trades_path(trade: trade, book: book), remote: true, class: :accept_trade do %>
            <i class="material-icons md-18">thumb_up</i>
          <% end %>
          </td>
          <td>
          <%= button_to decline_trade_trades_path(trade: trade), remote: true, class: :decline_trade do %>
            <i class="material-icons md-18">thumb_down</i>
          <% end %>
          </td>
      </tr>
    <% end %>
    </tbody>
  </table>
  </br>
  <h4 class="docs-header"><center>Here are all of the books you've already bid on:</center></h4>
  <table class="u-full-width">
    <thead>
      <tr>
        <th>Book</th>
        <th>Poster</th>
        <th>Location</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <% current_user.receiving_trades.where(status: :pending).each do |trade| %>
          <% book = Book.find(trade.book_id) %>
          <% posting_user = User.find(trade.posting_user) %>
          <td><a href="/book/<%= book.title %>"><%= book.title %></a></td>
          <td><%= posting_user.name %> </td>
          <td><%= posting_user.location.address %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
</div>
